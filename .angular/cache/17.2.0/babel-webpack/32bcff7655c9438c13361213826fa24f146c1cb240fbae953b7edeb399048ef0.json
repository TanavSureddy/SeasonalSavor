{"ast":null,"code":"import _asyncToGenerator from \"/Users/yogendra/repos/grocery/grocery-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { Validators } from \"@angular/forms\";\nimport axios from \"axios\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@ionic/angular\";\nimport * as i4 from \"src/app/services/cart/cart.service\";\nimport * as i5 from \"../../../services/order/order.service\";\nimport * as i6 from \"src/app/services/auth/auth.services\";\nimport * as i7 from \"../../../services/data-sharing.services\";\nimport * as i8 from \"@angular/common\";\nfunction PaymentPage_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \" Invalid card number \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction PaymentPage_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \" Card holder name is required \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction PaymentPage_div_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \" Invalid expiration date \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction PaymentPage_div_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \" Invalid CVV \");\n    i0.ɵɵelementEnd();\n  }\n}\nexport let PaymentPage = /*#__PURE__*/(() => {\n  class PaymentPage {\n    constructor(fb, router, alertController, cartServices, orderServices, authServices, toastController, dataSharingService) {\n      this.fb = fb;\n      this.router = router;\n      this.alertController = alertController;\n      this.cartServices = cartServices;\n      this.orderServices = orderServices;\n      this.authServices = authServices;\n      this.toastController = toastController;\n      this.dataSharingService = dataSharingService;\n    }\n    ngOnInit() {\n      this.paymentForm = this.fb.group({\n        cardNumber: ['', [Validators.required, Validators.pattern('[0-9]{4}-[0-9]{4}-[0-9]{4}-[0-9]{4}')]],\n        cardHolderName: ['', Validators.required],\n        expirationDate: ['', [Validators.required, Validators.pattern('(0[1-9]|1[0-2])\\/([0-9]{2})')]],\n        cvv: ['', [Validators.required, Validators.pattern('[0-9]{3}')]]\n      });\n      // Automatically add hyphens to card number input\n      this.paymentForm?.get('cardNumber')?.valueChanges.subscribe(value => {\n        if (value.length === 4 || value.length === 9 || value.length === 14) {\n          this.paymentForm.patchValue({\n            cardNumber: value + '-'\n          });\n        }\n      });\n    }\n    successToast(message) {\n      this.toastController.create({\n        message: message,\n        duration: 3000,\n        // Duration of the toast in milliseconds\n        position: \"bottom\",\n        // Position of the toast on the screen ('top', 'bottom', 'middle')\n        color: \"success\" // You can customize the color based on your app's theme\n      }).then(toast => {\n        toast.present();\n      });\n    }\n    errorToast(message) {\n      this.toastController.create({\n        message: message,\n        duration: 3000,\n        // Duration of the toast in milliseconds\n        position: \"top\",\n        // Position of the toast on the screen ('top', 'bottom', 'middle')\n        color: \"danger\" // You can customize the color based on your app's theme\n      }).then(toast => {\n        toast.present();\n      });\n    }\n    redirectToOrderSuccess() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        const userId = localStorage.getItem(\"userId\");\n        if (_this.authServices.isAuthenticated() && _this.cartServices.cartItems.length > 0) {\n          axios.post(`https://api.jykrasolutions.com/api/user/placeOrder/${userId}`, {\n            cartItems: _this.cartServices.getCartItems(),\n            address: _this.dataSharingService.getFormData(),\n            orderTime: new Date()\n          }).then(response => {\n            _this.dataSharingService.clearFormData();\n            _this.orderServices.recentOrderDetails = [];\n            _this.successToast(response.data.message);\n            _this.orderServices.recentOrderDetails.push(response.data);\n            //console.log(this.orderServices.recentOrderDetails[0]);\n            _this.cartServices.clearCart();\n            _this.orderServices.getOrderDetails();\n            _this.router.navigate([\"/tabs/order-sucess\"]);\n          }).catch(error => {\n            // Handle errors\n            console.error(\"Error:\", error);\n          });\n        } else {\n          _this.errorToast(\"Please login to place order\");\n          _this.router.navigate([\"/login\"]);\n        }\n      })();\n    }\n    static #_ = this.ɵfac = function PaymentPage_Factory(t) {\n      return new (t || PaymentPage)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.AlertController), i0.ɵɵdirectiveInject(i4.CartService), i0.ɵɵdirectiveInject(i5.OrderService), i0.ɵɵdirectiveInject(i6.AuthService), i0.ɵɵdirectiveInject(i3.ToastController), i0.ɵɵdirectiveInject(i7.DataSharingService));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: PaymentPage,\n      selectors: [[\"app-payment\"]],\n      decls: 30,\n      vars: 9,\n      consts: [[3, \"translucent\"], [3, \"fullscreen\"], [3, \"formGroup\"], [\"position\", \"floating\"], [\"type\", \"text\", \"formControlName\", \"cardNumber\", \"placeholder\", \"1234-5678-1209-4567\", \"area-label\", \"Card Number\"], [4, \"ngIf\"], [\"type\", \"text\", \"formControlName\", \"cardHolderName\", \"placeholder\", \"Card Holder Name\", \"area-label\", \"Card Holder Name\"], [\"type\", \"text\", \"formControlName\", \"expirationDate\", \"area-label\", \"Expiration Date (MM/YY)\"], [\"type\", \"number\", \"formControlName\", \"cvv\", \"placeholder\", \"123\", \"area-label\", \"CVV\"], [\"expand\", \"block\", \"type\", \"submit\", 3, \"disabled\", \"click\"]],\n      template: function PaymentPage_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"ion-header\", 0)(1, \"ion-toolbar\")(2, \"ion-title\");\n          i0.ɵɵtext(3, \"payment\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(4, \"ion-content\", 1)(5, \"ion-card\")(6, \"ion-card-content\")(7, \"form\", 2)(8, \"ion-item\")(9, \"ion-label\", 3);\n          i0.ɵɵtext(10, \"Card Number\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(11, \"ion-input\", 4);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(12, PaymentPage_div_12_Template, 2, 0, \"div\", 5);\n          i0.ɵɵelementStart(13, \"ion-item\")(14, \"ion-label\", 3);\n          i0.ɵɵtext(15, \"Card Holder Name\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(16, \"ion-input\", 6);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(17, PaymentPage_div_17_Template, 2, 0, \"div\", 5);\n          i0.ɵɵelementStart(18, \"ion-item\")(19, \"ion-label\", 3);\n          i0.ɵɵtext(20, \"Expiration Date (MM/YY)\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(21, \"ion-input\", 7);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(22, PaymentPage_div_22_Template, 2, 0, \"div\", 5);\n          i0.ɵɵelementStart(23, \"ion-item\")(24, \"ion-label\", 3);\n          i0.ɵɵtext(25, \"CVV\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(26, \"ion-input\", 8);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(27, PaymentPage_div_27_Template, 2, 0, \"div\", 5);\n          i0.ɵɵelementStart(28, \"ion-button\", 9);\n          i0.ɵɵlistener(\"click\", function PaymentPage_Template_ion_button_click_28_listener() {\n            return ctx.redirectToOrderSuccess();\n          });\n          i0.ɵɵtext(29);\n          i0.ɵɵelementEnd()()()()();\n        }\n        if (rf & 2) {\n          let tmp_3_0;\n          let tmp_4_0;\n          let tmp_5_0;\n          let tmp_6_0;\n          i0.ɵɵproperty(\"translucent\", true);\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"fullscreen\", true);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"formGroup\", ctx.paymentForm);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", (ctx.paymentForm == null ? null : (tmp_3_0 = ctx.paymentForm.get(\"cardNumber\")) == null ? null : tmp_3_0.invalid) && (ctx.paymentForm == null ? null : (tmp_3_0 = ctx.paymentForm.get(\"cardNumber\")) == null ? null : tmp_3_0.touched));\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", (ctx.paymentForm == null ? null : (tmp_4_0 = ctx.paymentForm.get(\"cardHolderName\")) == null ? null : tmp_4_0.invalid) && (ctx.paymentForm == null ? null : (tmp_4_0 = ctx.paymentForm.get(\"cardHolderName\")) == null ? null : tmp_4_0.touched));\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", (ctx.paymentForm == null ? null : (tmp_5_0 = ctx.paymentForm.get(\"expirationDate\")) == null ? null : tmp_5_0.invalid) && (ctx.paymentForm == null ? null : (tmp_5_0 = ctx.paymentForm.get(\"expirationDate\")) == null ? null : tmp_5_0.touched));\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", (ctx.paymentForm == null ? null : (tmp_6_0 = ctx.paymentForm.get(\"cvv\")) == null ? null : tmp_6_0.invalid) && (ctx.paymentForm == null ? null : (tmp_6_0 = ctx.paymentForm.get(\"cvv\")) == null ? null : tmp_6_0.touched));\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"disabled\", ctx.paymentForm.invalid);\n          i0.ɵɵadvance();\n          i0.ɵɵtextInterpolate1(\"Pay \\u20B9\", ctx.cartServices.totalCartValue, \"\");\n        }\n      },\n      dependencies: [i8.NgIf, i1.ɵNgNoValidate, i1.NgControlStatus, i1.NgControlStatusGroup, i3.IonButton, i3.IonCard, i3.IonCardContent, i3.IonContent, i3.IonHeader, i3.IonInput, i3.IonItem, i3.IonLabel, i3.IonTitle, i3.IonToolbar, i3.NumericValueAccessor, i3.TextValueAccessor, i1.FormGroupDirective, i1.FormControlName],\n      styles: [\"ion-card[_ngcontent-%COMP%]{margin:20px}ion-item[_ngcontent-%COMP%]{margin-bottom:15px}\"]\n    });\n  }\n  return PaymentPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}